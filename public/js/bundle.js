require=function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){var global=typeof self!=="undefined"?self:typeof window!=="undefined"?window:{};(function(){var root=this;var previousBackbone=root.Backbone;var array=[];var push=array.push;var slice=array.slice;var splice=array.splice;var Backbone;if(typeof exports!=="undefined"){Backbone=exports}else{Backbone=root.Backbone={}}Backbone.VERSION="1.1.0";var _=root._;if(!_&&typeof require!=="undefined")_=require("underscore");Backbone.$=root.jQuery||root.Zepto||root.ender||root.$;Backbone.noConflict=function(){root.Backbone=previousBackbone;return this};Backbone.emulateHTTP=false;Backbone.emulateJSON=false;var Events=Backbone.Events={on:function(name,callback,context){if(!eventsApi(this,"on",name,[callback,context])||!callback)return this;this._events||(this._events={});var events=this._events[name]||(this._events[name]=[]);events.push({callback:callback,context:context,ctx:context||this});return this},once:function(name,callback,context){if(!eventsApi(this,"once",name,[callback,context])||!callback)return this;var self=this;var once=_.once(function(){self.off(name,once);callback.apply(this,arguments)});once._callback=callback;return this.on(name,once,context)},off:function(name,callback,context){var retain,ev,events,names,i,l,j,k;if(!this._events||!eventsApi(this,"off",name,[callback,context]))return this;if(!name&&!callback&&!context){this._events={};return this}names=name?[name]:_.keys(this._events);for(i=0,l=names.length;i<l;i++){name=names[i];if(events=this._events[name]){this._events[name]=retain=[];if(callback||context){for(j=0,k=events.length;j<k;j++){ev=events[j];if(callback&&callback!==ev.callback&&callback!==ev.callback._callback||context&&context!==ev.context){retain.push(ev)}}}if(!retain.length)delete this._events[name]}}return this},trigger:function(name){if(!this._events)return this;var args=slice.call(arguments,1);if(!eventsApi(this,"trigger",name,args))return this;var events=this._events[name];var allEvents=this._events.all;if(events)triggerEvents(events,args);if(allEvents)triggerEvents(allEvents,arguments);return this},stopListening:function(obj,name,callback){var listeningTo=this._listeningTo;if(!listeningTo)return this;var remove=!name&&!callback;if(!callback&&typeof name==="object")callback=this;if(obj)(listeningTo={})[obj._listenId]=obj;for(var id in listeningTo){obj=listeningTo[id];obj.off(name,callback,this);if(remove||_.isEmpty(obj._events))delete this._listeningTo[id]}return this}};var eventSplitter=/\s+/;var eventsApi=function(obj,action,name,rest){if(!name)return true;if(typeof name==="object"){for(var key in name){obj[action].apply(obj,[key,name[key]].concat(rest))}return false}if(eventSplitter.test(name)){var names=name.split(eventSplitter);for(var i=0,l=names.length;i<l;i++){obj[action].apply(obj,[names[i]].concat(rest))}return false}return true};var triggerEvents=function(events,args){var ev,i=-1,l=events.length,a1=args[0],a2=args[1],a3=args[2];switch(args.length){case 0:while(++i<l)(ev=events[i]).callback.call(ev.ctx);return;case 1:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1);return;case 2:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2);return;case 3:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2,a3);return;default:while(++i<l)(ev=events[i]).callback.apply(ev.ctx,args)}};var listenMethods={listenTo:"on",listenToOnce:"once"};_.each(listenMethods,function(implementation,method){Events[method]=function(obj,name,callback){var listeningTo=this._listeningTo||(this._listeningTo={});var id=obj._listenId||(obj._listenId=_.uniqueId("l"));listeningTo[id]=obj;if(!callback&&typeof name==="object")callback=this;obj[implementation](name,callback,this);return this}});Events.bind=Events.on;Events.unbind=Events.off;_.extend(Backbone,Events);var Model=Backbone.Model=function(attributes,options){var attrs=attributes||{};options||(options={});this.cid=_.uniqueId("c");this.attributes={};if(options.collection)this.collection=options.collection;if(options.parse)attrs=this.parse(attrs,options)||{};attrs=_.defaults({},attrs,_.result(this,"defaults"));this.set(attrs,options);this.changed={};this.initialize.apply(this,arguments)};_.extend(Model.prototype,Events,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(options){return _.clone(this.attributes)},sync:function(){return Backbone.sync.apply(this,arguments)},get:function(attr){return this.attributes[attr]},escape:function(attr){return _.escape(this.get(attr))},has:function(attr){return this.get(attr)!=null},set:function(key,val,options){var attr,attrs,unset,changes,silent,changing,prev,current;if(key==null)return this;if(typeof key==="object"){attrs=key;options=val}else{(attrs={})[key]=val}options||(options={});if(!this._validate(attrs,options))return false;unset=options.unset;silent=options.silent;changes=[];changing=this._changing;this._changing=true;if(!changing){this._previousAttributes=_.clone(this.attributes);this.changed={}}current=this.attributes,prev=this._previousAttributes;if(this.idAttribute in attrs)this.id=attrs[this.idAttribute];for(attr in attrs){val=attrs[attr];if(!_.isEqual(current[attr],val))changes.push(attr);if(!_.isEqual(prev[attr],val)){this.changed[attr]=val}else{delete this.changed[attr]}unset?delete current[attr]:current[attr]=val}if(!silent){if(changes.length)this._pending=true;for(var i=0,l=changes.length;i<l;i++){this.trigger("change:"+changes[i],this,current[changes[i]],options)}}if(changing)return this;if(!silent){while(this._pending){this._pending=false;this.trigger("change",this,options)}}this._pending=false;this._changing=false;return this},unset:function(attr,options){return this.set(attr,void 0,_.extend({},options,{unset:true}))},clear:function(options){var attrs={};for(var key in this.attributes)attrs[key]=void 0;return this.set(attrs,_.extend({},options,{unset:true}))},hasChanged:function(attr){if(attr==null)return!_.isEmpty(this.changed);return _.has(this.changed,attr)},changedAttributes:function(diff){if(!diff)return this.hasChanged()?_.clone(this.changed):false;var val,changed=false;var old=this._changing?this._previousAttributes:this.attributes;for(var attr in diff){if(_.isEqual(old[attr],val=diff[attr]))continue;(changed||(changed={}))[attr]=val}return changed},previous:function(attr){if(attr==null||!this._previousAttributes)return null;return this._previousAttributes[attr]},previousAttributes:function(){return _.clone(this._previousAttributes)},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0)options.parse=true;var model=this;var success=options.success;options.success=function(resp){if(!model.set(model.parse(resp,options),options))return false;if(success)success(model,resp,options);model.trigger("sync",model,resp,options)};wrapError(this,options);return this.sync("read",this,options)},save:function(key,val,options){var attrs,method,xhr,attributes=this.attributes;if(key==null||typeof key==="object"){attrs=key;options=val}else{(attrs={})[key]=val}options=_.extend({validate:true},options);if(attrs&&!options.wait){if(!this.set(attrs,options))return false}else{if(!this._validate(attrs,options))return false}if(attrs&&options.wait){this.attributes=_.extend({},attributes,attrs)}if(options.parse===void 0)options.parse=true;var model=this;var success=options.success;options.success=function(resp){model.attributes=attributes;var serverAttrs=model.parse(resp,options);if(options.wait)serverAttrs=_.extend(attrs||{},serverAttrs);if(_.isObject(serverAttrs)&&!model.set(serverAttrs,options)){return false}if(success)success(model,resp,options);model.trigger("sync",model,resp,options)};wrapError(this,options);method=this.isNew()?"create":options.patch?"patch":"update";if(method==="patch")options.attrs=attrs;xhr=this.sync(method,this,options);if(attrs&&options.wait)this.attributes=attributes;return xhr},destroy:function(options){options=options?_.clone(options):{};var model=this;var success=options.success;var destroy=function(){model.trigger("destroy",model,model.collection,options)};options.success=function(resp){if(options.wait||model.isNew())destroy();if(success)success(model,resp,options);if(!model.isNew())model.trigger("sync",model,resp,options)};if(this.isNew()){options.success();return false}wrapError(this,options);var xhr=this.sync("delete",this,options);if(!options.wait)destroy();return xhr},url:function(){var base=_.result(this,"urlRoot")||_.result(this.collection,"url")||urlError();if(this.isNew())return base;return base+(base.charAt(base.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(options){return this._validate({},_.extend(options||{},{validate:true}))},_validate:function(attrs,options){if(!options.validate||!this.validate)return true;attrs=_.extend({},this.attributes,attrs);var error=this.validationError=this.validate(attrs,options)||null;if(!error)return true;this.trigger("invalid",this,error,_.extend(options,{validationError:error}));return false}});var modelMethods=["keys","values","pairs","invert","pick","omit"];_.each(modelMethods,function(method){Model.prototype[method]=function(){var args=slice.call(arguments);args.unshift(this.attributes);return _[method].apply(_,args)}});var Collection=Backbone.Collection=function(models,options){options||(options={});if(options.model)this.model=options.model;if(options.comparator!==void 0)this.comparator=options.comparator;this._reset();this.initialize.apply(this,arguments);if(models)this.reset(models,_.extend({silent:true},options))};var setOptions={add:true,remove:true,merge:true};var addOptions={add:true,remove:false};_.extend(Collection.prototype,Events,{model:Model,initialize:function(){},toJSON:function(options){return this.map(function(model){return model.toJSON(options)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(models,options){return this.set(models,_.extend({merge:false},options,addOptions))},remove:function(models,options){var singular=!_.isArray(models);models=singular?[models]:_.clone(models);options||(options={});var i,l,index,model;for(i=0,l=models.length;i<l;i++){model=models[i]=this.get(models[i]);if(!model)continue;delete this._byId[model.id];delete this._byId[model.cid];index=this.indexOf(model);this.models.splice(index,1);this.length--;if(!options.silent){options.index=index;model.trigger("remove",model,this,options)}this._removeReference(model)}return singular?models[0]:models},set:function(models,options){options=_.defaults({},options,setOptions);if(options.parse)models=this.parse(models,options);var singular=!_.isArray(models);models=singular?models?[models]:[]:_.clone(models);var i,l,id,model,attrs,existing,sort;var at=options.at;var targetModel=this.model;var sortable=this.comparator&&at==null&&options.sort!==false;var sortAttr=_.isString(this.comparator)?this.comparator:null;var toAdd=[],toRemove=[],modelMap={};var add=options.add,merge=options.merge,remove=options.remove;var order=!sortable&&add&&remove?[]:false;for(i=0,l=models.length;i<l;i++){attrs=models[i];if(attrs instanceof Model){id=model=attrs}else{id=attrs[targetModel.prototype.idAttribute]}if(existing=this.get(id)){if(remove)modelMap[existing.cid]=true;if(merge){attrs=attrs===model?model.attributes:attrs;if(options.parse)attrs=existing.parse(attrs,options);existing.set(attrs,options);if(sortable&&!sort&&existing.hasChanged(sortAttr))sort=true}models[i]=existing}else if(add){model=models[i]=this._prepareModel(attrs,options);if(!model)continue;toAdd.push(model);model.on("all",this._onModelEvent,this);this._byId[model.cid]=model;if(model.id!=null)this._byId[model.id]=model}if(order)order.push(existing||model)}if(remove){for(i=0,l=this.length;i<l;++i){if(!modelMap[(model=this.models[i]).cid])toRemove.push(model)}if(toRemove.length)this.remove(toRemove,options)}if(toAdd.length||order&&order.length){if(sortable)sort=true;this.length+=toAdd.length;if(at!=null){for(i=0,l=toAdd.length;i<l;i++){this.models.splice(at+i,0,toAdd[i])}}else{if(order)this.models.length=0;var orderedModels=order||toAdd;for(i=0,l=orderedModels.length;i<l;i++){this.models.push(orderedModels[i])}}}if(sort)this.sort({silent:true});if(!options.silent){for(i=0,l=toAdd.length;i<l;i++){(model=toAdd[i]).trigger("add",model,this,options)}if(sort||order&&order.length)this.trigger("sort",this,options)}return singular?models[0]:models},reset:function(models,options){options||(options={});for(var i=0,l=this.models.length;i<l;i++){this._removeReference(this.models[i])}options.previousModels=this.models;this._reset();models=this.add(models,_.extend({silent:true},options));if(!options.silent)this.trigger("reset",this,options);return models},push:function(model,options){return this.add(model,_.extend({at:this.length},options))},pop:function(options){var model=this.at(this.length-1);this.remove(model,options);return model},unshift:function(model,options){return this.add(model,_.extend({at:0},options))},shift:function(options){var model=this.at(0);this.remove(model,options);return model},slice:function(){return slice.apply(this.models,arguments)},get:function(obj){if(obj==null)return void 0;return this._byId[obj.id]||this._byId[obj.cid]||this._byId[obj]},at:function(index){return this.models[index]},where:function(attrs,first){if(_.isEmpty(attrs))return first?void 0:[];return this[first?"find":"filter"](function(model){for(var key in attrs){if(attrs[key]!==model.get(key))return false}return true})},findWhere:function(attrs){return this.where(attrs,true)},sort:function(options){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");options||(options={});if(_.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(_.bind(this.comparator,this))}if(!options.silent)this.trigger("sort",this,options);return this},pluck:function(attr){return _.invoke(this.models,"get",attr)},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0)options.parse=true;var success=options.success;var collection=this;options.success=function(resp){var method=options.reset?"reset":"set";collection[method](resp,options);if(success)success(collection,resp,options);collection.trigger("sync",collection,resp,options)};wrapError(this,options);return this.sync("read",this,options)},create:function(model,options){options=options?_.clone(options):{};if(!(model=this._prepareModel(model,options)))return false;if(!options.wait)this.add(model,options);var collection=this;var success=options.success;options.success=function(model,resp,options){if(options.wait)collection.add(model,options);if(success)success(model,resp,options)};model.save(null,options);return model},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(attrs,options){if(attrs instanceof Model){if(!attrs.collection)attrs.collection=this;return attrs}options=options?_.clone(options):{};options.collection=this;var model=new this.model(attrs,options);if(!model.validationError)return model;this.trigger("invalid",this,model.validationError,options);return false},_removeReference:function(model){if(this===model.collection)delete model.collection;model.off("all",this._onModelEvent,this)},_onModelEvent:function(event,model,collection,options){if((event==="add"||event==="remove")&&collection!==this)return;if(event==="destroy")this.remove(model,options);if(model&&event==="change:"+model.idAttribute){delete this._byId[model.previous(model.idAttribute)];if(model.id!=null)this._byId[model.id]=model}this.trigger.apply(this,arguments)}});var methods=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];_.each(methods,function(method){Collection.prototype[method]=function(){var args=slice.call(arguments);args.unshift(this.models);return _[method].apply(_,args)}});var attributeMethods=["groupBy","countBy","sortBy"];_.each(attributeMethods,function(method){Collection.prototype[method]=function(value,context){var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _[method](this.models,iterator,context)}});var View=Backbone.View=function(options){this.cid=_.uniqueId("view");options||(options={});_.extend(this,_.pick(options,viewOptions));this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var delegateEventSplitter=/^(\S+)\s*(.*)$/;var viewOptions=["model","collection","el","id","attributes","className","tagName","events"];_.extend(View.prototype,Events,{tagName:"div",$:function(selector){return this.$el.find(selector)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(element,delegate){if(this.$el)this.undelegateEvents();this.$el=element instanceof Backbone.$?element:Backbone.$(element);this.el=this.$el[0];if(delegate!==false)this.delegateEvents();return this},delegateEvents:function(events){if(!(events||(events=_.result(this,"events"))))return this;this.undelegateEvents();for(var key in events){var method=events[key];if(!_.isFunction(method))method=this[events[key]];if(!method)continue;var match=key.match(delegateEventSplitter);var eventName=match[1],selector=match[2];method=_.bind(method,this);eventName+=".delegateEvents"+this.cid;if(selector===""){this.$el.on(eventName,method)}else{this.$el.on(eventName,selector,method)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_ensureElement:function(){if(!this.el){var attrs=_.extend({},_.result(this,"attributes"));if(this.id)attrs.id=_.result(this,"id");if(this.className)attrs["class"]=_.result(this,"className");var $el=Backbone.$("<"+_.result(this,"tagName")+">").attr(attrs);this.setElement($el,false)}else{this.setElement(_.result(this,"el"),false)}}});Backbone.sync=function(method,model,options){var type=methodMap[method];_.defaults(options||(options={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var params={type:type,dataType:"json"};if(!options.url){params.url=_.result(model,"url")||urlError()}if(options.data==null&&model&&(method==="create"||method==="update"||method==="patch")){params.contentType="application/json";params.data=JSON.stringify(options.attrs||model.toJSON(options))}if(options.emulateJSON){params.contentType="application/x-www-form-urlencoded";params.data=params.data?{model:params.data}:{}}if(options.emulateHTTP&&(type==="PUT"||type==="DELETE"||type==="PATCH")){params.type="POST";if(options.emulateJSON)params.data._method=type;var beforeSend=options.beforeSend;options.beforeSend=function(xhr){xhr.setRequestHeader("X-HTTP-Method-Override",type);if(beforeSend)return beforeSend.apply(this,arguments)}}if(params.type!=="GET"&&!options.emulateJSON){params.processData=false}if(params.type==="PATCH"&&noXhrPatch){params.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var xhr=options.xhr=Backbone.ajax(_.extend(params,options));model.trigger("request",model,xhr,options);return xhr};var noXhrPatch=typeof window!=="undefined"&&!!window.ActiveXObject&&!(window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent);var methodMap={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};Backbone.ajax=function(){return Backbone.$.ajax.apply(Backbone.$,arguments)};var Router=Backbone.Router=function(options){options||(options={});if(options.routes)this.routes=options.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var optionalParam=/\((.*?)\)/g;var namedParam=/(\(\?)?:\w+/g;var splatParam=/\*\w+/g;var escapeRegExp=/[\-{}\[\]+?.,\\\^$|#\s]/g;_.extend(Router.prototype,Events,{initialize:function(){},route:function(route,name,callback){if(!_.isRegExp(route))route=this._routeToRegExp(route);if(_.isFunction(name)){callback=name;name=""}if(!callback)callback=this[name];var router=this;Backbone.history.route(route,function(fragment){var args=router._extractParameters(route,fragment);callback&&callback.apply(router,args);router.trigger.apply(router,["route:"+name].concat(args));router.trigger("route",name,args);Backbone.history.trigger("route",router,name,args)});return this},navigate:function(fragment,options){Backbone.history.navigate(fragment,options);return this},_bindRoutes:function(){if(!this.routes)return;this.routes=_.result(this,"routes");var route,routes=_.keys(this.routes);while((route=routes.pop())!=null){this.route(route,this.routes[route])}},_routeToRegExp:function(route){route=route.replace(escapeRegExp,"\\$&").replace(optionalParam,"(?:$1)?").replace(namedParam,function(match,optional){return optional?match:"([^/]+)"}).replace(splatParam,"(.*?)");return new RegExp("^"+route+"$")},_extractParameters:function(route,fragment){var params=route.exec(fragment).slice(1);return _.map(params,function(param){return param?decodeURIComponent(param):null})}});var History=Backbone.History=function(){this.handlers=[];_.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var routeStripper=/^[#\/]|\s+$/g;var rootStripper=/^\/+|\/+$/g;var isExplorer=/msie [\w.]+/;var trailingSlash=/\/$/;var pathStripper=/[?#].*$/;History.started=false;_.extend(History.prototype,Events,{interval:50,getHash:function(window){var match=(window||this).location.href.match(/#(.*)$/);return match?match[1]:""},getFragment:function(fragment,forcePushState){if(fragment==null){if(this._hasPushState||!this._wantsHashChange||forcePushState){fragment=this.location.pathname;var root=this.root.replace(trailingSlash,"");if(!fragment.indexOf(root))fragment=fragment.slice(root.length)}else{fragment=this.getHash()}}return fragment.replace(routeStripper,"")},start:function(options){if(History.started)throw new Error("Backbone.history has already been started");History.started=true;this.options=_.extend({root:"/"},this.options,options);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var fragment=this.getFragment();var docMode=document.documentMode;var oldIE=isExplorer.exec(navigator.userAgent.toLowerCase())&&(!docMode||docMode<=7);this.root=("/"+this.root+"/").replace(rootStripper,"/");if(oldIE&&this._wantsHashChange){this.iframe=Backbone.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(fragment)}if(this._hasPushState){Backbone.$(window).on("popstate",this.checkUrl)}else if(this._wantsHashChange&&"onhashchange"in window&&!oldIE){Backbone.$(window).on("hashchange",this.checkUrl)}else if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}this.fragment=fragment;var loc=this.location;var atRoot=loc.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!atRoot){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+"#"+this.fragment);return true}else if(this._hasPushState&&atRoot&&loc.hash){this.fragment=this.getHash().replace(routeStripper,"");this.history.replaceState({},document.title,this.root+this.fragment+loc.search)}}if(!this.options.silent)return this.loadUrl()},stop:function(){Backbone.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);History.started=false},route:function(route,callback){this.handlers.unshift({route:route,callback:callback})},checkUrl:function(e){var current=this.getFragment();if(current===this.fragment&&this.iframe){current=this.getFragment(this.getHash(this.iframe))}if(current===this.fragment)return false;if(this.iframe)this.navigate(current);this.loadUrl()},loadUrl:function(fragment){fragment=this.fragment=this.getFragment(fragment);return _.any(this.handlers,function(handler){if(handler.route.test(fragment)){handler.callback(fragment);return true}})},navigate:function(fragment,options){if(!History.started)return false;if(!options||options===true)options={trigger:!!options};var url=this.root+(fragment=this.getFragment(fragment||""));fragment=fragment.replace(pathStripper,"");if(this.fragment===fragment)return;this.fragment=fragment;if(fragment===""&&url!=="/")url=url.slice(0,-1);if(this._hasPushState){this.history[options.replace?"replaceState":"pushState"]({},document.title,url)}else if(this._wantsHashChange){this._updateHash(this.location,fragment,options.replace);if(this.iframe&&fragment!==this.getFragment(this.getHash(this.iframe))){if(!options.replace)this.iframe.document.open().close();this._updateHash(this.iframe.location,fragment,options.replace)}}else{return this.location.assign(url)}if(options.trigger)return this.loadUrl(fragment)},_updateHash:function(location,fragment,replace){if(replace){var href=location.href.replace(/(javascript:|#).*$/,"");location.replace(href+"#"+fragment)}else{location.hash="#"+fragment}}});Backbone.history=new History;var extend=function(protoProps,staticProps){var parent=this;var child;if(protoProps&&_.has(protoProps,"constructor")){child=protoProps.constructor}else{child=function(){return parent.apply(this,arguments)}}_.extend(child,parent,staticProps);var Surrogate=function(){this.constructor=child};Surrogate.prototype=parent.prototype;child.prototype=new Surrogate;if(protoProps)_.extend(child.prototype,protoProps);child.__super__=parent.prototype;return child};Model.extend=Collection.extend=Router.extend=View.extend=History.extend=extend;var urlError=function(){throw new Error('A "url" property or function must be specified')};var wrapError=function(model,options){var error=options.error;options.error=function(resp){if(error)error(model,resp,options);model.trigger("error",model,resp,options)}}}).call(global||window)},{underscore:10}],2:[function(require,module,exports){var toString=Object.prototype.toString;var hasOwnProperty=Object.prototype.hasOwnProperty;function isArray(xs){return toString.call(xs)==="[object Array]"}exports.isArray=typeof Array.isArray==="function"?Array.isArray:isArray;exports.indexOf=function indexOf(xs,x){if(xs.indexOf)return xs.indexOf(x);for(var i=0;i<xs.length;i++){if(x===xs[i])return i}return-1};exports.filter=function filter(xs,fn){if(xs.filter)return xs.filter(fn);var res=[];for(var i=0;i<xs.length;i++){if(fn(xs[i],i,xs))res.push(xs[i])}return res};exports.forEach=function forEach(xs,fn,self){if(xs.forEach)return xs.forEach(fn,self);for(var i=0;i<xs.length;i++){fn.call(self,xs[i],i,xs)}};exports.map=function map(xs,fn){if(xs.map)return xs.map(fn);var out=new Array(xs.length);for(var i=0;i<xs.length;i++){out[i]=fn(xs[i],i,xs)}return out};exports.reduce=function reduce(array,callback,opt_initialValue){if(array.reduce)return array.reduce(callback,opt_initialValue);var value,isValueSet=false;if(2<arguments.length){value=opt_initialValue;isValueSet=true}for(var i=0,l=array.length;l>i;++i){if(array.hasOwnProperty(i)){if(isValueSet){value=callback(value,array[i],i,array)}else{value=array[i];isValueSet=true}}}return value};if("ab".substr(-1)!=="b"){exports.substr=function(str,start,length){if(start<0)start=str.length+start;return str.substr(start,length)}}else{exports.substr=function(str,start,length){return str.substr(start,length)}}exports.trim=function(str){if(str.trim)return str.trim();return str.replace(/^\s+|\s+$/g,"")};exports.bind=function(){var args=Array.prototype.slice.call(arguments);var fn=args.shift();if(fn.bind)return fn.bind.apply(fn,args);var self=args.shift();return function(){fn.apply(self,args.concat([Array.prototype.slice.call(arguments)]))}};function create(prototype,properties){var object;if(prototype===null){object={__proto__:null}}else{if(typeof prototype!=="object"){throw new TypeError("typeof prototype["+typeof prototype+"] != 'object'")}var Type=function(){};Type.prototype=prototype;object=new Type;object.__proto__=prototype}if(typeof properties!=="undefined"&&Object.defineProperties){Object.defineProperties(object,properties)}return object}exports.create=typeof Object.create==="function"?Object.create:create;function notObject(object){return typeof object!="object"&&typeof object!="function"||object===null}function keysShim(object){if(notObject(object)){throw new TypeError("Object.keys called on a non-object")}var result=[];for(var name in object){if(hasOwnProperty.call(object,name)){result.push(name)}}return result}function propertyShim(object){if(notObject(object)){throw new TypeError("Object.getOwnPropertyNames called on a non-object")}var result=keysShim(object);if(exports.isArray(object)&&exports.indexOf(object,"length")===-1){result.push("length")}return result}var keys=typeof Object.keys==="function"?Object.keys:keysShim;var getOwnPropertyNames=typeof Object.getOwnPropertyNames==="function"?Object.getOwnPropertyNames:propertyShim;if((new Error).hasOwnProperty("description")){var ERROR_PROPERTY_FILTER=function(obj,array){if(toString.call(obj)==="[object Error]"){array=exports.filter(array,function(name){return name!=="description"&&name!=="number"&&name!=="message"})}return array};exports.keys=function(object){return ERROR_PROPERTY_FILTER(object,keys(object))};exports.getOwnPropertyNames=function(object){return ERROR_PROPERTY_FILTER(object,getOwnPropertyNames(object))}}else{exports.keys=keys;exports.getOwnPropertyNames=getOwnPropertyNames}function valueObject(value,key){return{value:value[key]}}if(typeof Object.getOwnPropertyDescriptor==="function"){try{Object.getOwnPropertyDescriptor({a:1},"a");exports.getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor}catch(e){exports.getOwnPropertyDescriptor=function(value,key){try{return Object.getOwnPropertyDescriptor(value,key)}catch(e){return valueObject(value,key)}}}}else{exports.getOwnPropertyDescriptor=valueObject}},{}],3:[function(require,module,exports){},{}],4:[function(require,module,exports){var process=require("__browserify_process");var util=require("util");var shims=require("_shims");function normalizeArray(parts,allowAboveRoot){var up=0;for(var i=parts.length-1;i>=0;i--){var last=parts[i];if(last==="."){parts.splice(i,1)}else if(last===".."){parts.splice(i,1);up++}else if(up){parts.splice(i,1);up--}}if(allowAboveRoot){for(;up--;up){parts.unshift("..")}}return parts}var splitPathRe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;var splitPath=function(filename){return splitPathRe.exec(filename).slice(1)};exports.resolve=function(){var resolvedPath="",resolvedAbsolute=false;for(var i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if(!util.isString(path)){throw new TypeError("Arguments to path.resolve must be strings")}else if(!path){continue}resolvedPath=path+"/"+resolvedPath;resolvedAbsolute=path.charAt(0)==="/"}resolvedPath=normalizeArray(shims.filter(resolvedPath.split("/"),function(p){return!!p}),!resolvedAbsolute).join("/");return(resolvedAbsolute?"/":"")+resolvedPath||"."};exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash=shims.substr(path,-1)==="/";path=normalizeArray(shims.filter(path.split("/"),function(p){return!!p}),!isAbsolute).join("/");
if(!path&&!isAbsolute){path="."}if(path&&trailingSlash){path+="/"}return(isAbsolute?"/":"")+path};exports.isAbsolute=function(path){return path.charAt(0)==="/"};exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(shims.filter(paths,function(p,index){if(!util.isString(p)){throw new TypeError("Arguments to path.join must be strings")}return p}).join("/"))};exports.relative=function(from,to){from=exports.resolve(from).substr(1);to=exports.resolve(to).substr(1);function trim(arr){var start=0;for(;start<arr.length;start++){if(arr[start]!=="")break}var end=arr.length-1;for(;end>=0;end--){if(arr[end]!=="")break}if(start>end)return[];return arr.slice(start,end-start+1)}var fromParts=trim(from.split("/"));var toParts=trim(to.split("/"));var length=Math.min(fromParts.length,toParts.length);var samePartsLength=length;for(var i=0;i<length;i++){if(fromParts[i]!==toParts[i]){samePartsLength=i;break}}var outputParts=[];for(var i=samePartsLength;i<fromParts.length;i++){outputParts.push("..")}outputParts=outputParts.concat(toParts.slice(samePartsLength));return outputParts.join("/")};exports.sep="/";exports.delimiter=":";exports.dirname=function(path){var result=splitPath(path),root=result[0],dir=result[1];if(!root&&!dir){return"."}if(dir){dir=dir.substr(0,dir.length-1)}return root+dir};exports.basename=function(path,ext){var f=splitPath(path)[2];if(ext&&f.substr(-1*ext.length)===ext){f=f.substr(0,f.length-ext.length)}return f};exports.extname=function(path){return splitPath(path)[3]}},{__browserify_process:6,_shims:2,util:5}],5:[function(require,module,exports){var shims=require("_shims");var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){var objects=[];for(var i=0;i<arguments.length;i++){objects.push(inspect(arguments[i]))}return objects.join(" ")}var i=1;var args=arguments;var len=args.length;var str=String(f).replace(formatRegExp,function(x){if(x==="%%")return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}});for(var x=args[i];i<len;x=args[++i]){if(isNull(x)||!isObject(x)){str+=" "+x}else{str+=" "+inspect(x)}}return str};function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};if(arguments.length>=3)ctx.depth=arguments[2];if(arguments.length>=4)ctx.colors=arguments[3];if(isBoolean(opts)){ctx.showHidden=opts}else if(opts){exports._extend(ctx,opts)}if(isUndefined(ctx.showHidden))ctx.showHidden=false;if(isUndefined(ctx.depth))ctx.depth=2;if(isUndefined(ctx.colors))ctx.colors=false;if(isUndefined(ctx.customInspect))ctx.customInspect=true;if(ctx.colors)ctx.stylize=stylizeWithColor;return formatValue(ctx,obj,ctx.depth)}exports.inspect=inspect;inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};inspect.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];if(style){return"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m"}else{return str}}function stylizeNoColor(str,styleType){return str}function arrayToHash(array){var hash={};shims.forEach(array,function(val,idx){hash[val]=true});return hash}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&!(value.constructor&&value.constructor.prototype===value)){var ret=value.inspect(recurseTimes);if(!isString(ret)){ret=formatValue(ctx,ret,recurseTimes)}return ret}var primitive=formatPrimitive(ctx,value);if(primitive){return primitive}var keys=shims.keys(value);var visibleKeys=arrayToHash(keys);if(ctx.showHidden){keys=shims.getOwnPropertyNames(value)}if(keys.length===0){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}if(isDate(value)){return ctx.stylize(Date.prototype.toString.call(value),"date")}if(isError(value)){return formatError(value)}}var base="",array=false,braces=["{","}"];if(isArray(value)){array=true;braces=["[","]"]}if(isFunction(value)){var n=value.name?": "+value.name:"";base=" [Function"+n+"]"}if(isRegExp(value)){base=" "+RegExp.prototype.toString.call(value)}if(isDate(value)){base=" "+Date.prototype.toUTCString.call(value)}if(isError(value)){base=" "+formatError(value)}if(keys.length===0&&(!array||value.length==0)){return braces[0]+base+braces[1]}if(recurseTimes<0){if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}else{return ctx.stylize("[Object]","special")}}ctx.seen.push(value);var output;if(array){output=formatArray(ctx,value,recurseTimes,visibleKeys,keys)}else{output=keys.map(function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)})}ctx.seen.pop();return reduceToSingleString(output,base,braces)}function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}if(isNumber(value))return ctx.stylize(""+value,"number");if(isBoolean(value))return ctx.stylize(""+value,"boolean");if(isNull(value))return ctx.stylize("null","null")}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){var output=[];for(var i=0,l=value.length;i<l;++i){if(hasOwnProperty(value,String(i))){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),true))}else{output.push("")}}shims.forEach(keys,function(key){if(!key.match(/^\d+$/)){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,true))}});return output}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;desc=shims.getOwnPropertyDescriptor(value,key)||{value:value[key]};if(desc.get){if(desc.set){str=ctx.stylize("[Getter/Setter]","special")}else{str=ctx.stylize("[Getter]","special")}}else{if(desc.set){str=ctx.stylize("[Setter]","special")}}if(!hasOwnProperty(visibleKeys,key)){name="["+key+"]"}if(!str){if(shims.indexOf(ctx.seen,desc.value)<0){if(isNull(recurseTimes)){str=formatValue(ctx,desc.value,null)}else{str=formatValue(ctx,desc.value,recurseTimes-1)}if(str.indexOf("\n")>-1){if(array){str=str.split("\n").map(function(line){return"  "+line}).join("\n").substr(2)}else{str="\n"+str.split("\n").map(function(line){return"   "+line}).join("\n")}}}else{str=ctx.stylize("[Circular]","special")}}if(isUndefined(name)){if(array&&key.match(/^\d+$/)){return str}name=JSON.stringify(""+key);if(name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){name=name.substr(1,name.length-2);name=ctx.stylize(name,"name")}else{name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");name=ctx.stylize(name,"string")}}return name+": "+str}function reduceToSingleString(output,base,braces){var numLinesEst=0;var length=shims.reduce(output,function(prev,cur){numLinesEst++;if(cur.indexOf("\n")>=0)numLinesEst++;return prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1},0);if(length>60){return braces[0]+(base===""?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]}return braces[0]+base+" "+output.join(", ")+" "+braces[1]}function isArray(ar){return shims.isArray(ar)}exports.isArray=isArray;function isBoolean(arg){return typeof arg==="boolean"}exports.isBoolean=isBoolean;function isNull(arg){return arg===null}exports.isNull=isNull;function isNullOrUndefined(arg){return arg==null}exports.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==="number"}exports.isNumber=isNumber;function isString(arg){return typeof arg==="string"}exports.isString=isString;function isSymbol(arg){return typeof arg==="symbol"}exports.isSymbol=isSymbol;function isUndefined(arg){return arg===void 0}exports.isUndefined=isUndefined;function isRegExp(re){return isObject(re)&&objectToString(re)==="[object RegExp]"}exports.isRegExp=isRegExp;function isObject(arg){return typeof arg==="object"&&arg}exports.isObject=isObject;function isDate(d){return isObject(d)&&objectToString(d)==="[object Date]"}exports.isDate=isDate;function isError(e){return isObject(e)&&objectToString(e)==="[object Error]"}exports.isError=isError;function isFunction(arg){return typeof arg==="function"}exports.isFunction=isFunction;function isPrimitive(arg){return arg===null||typeof arg==="boolean"||typeof arg==="number"||typeof arg==="string"||typeof arg==="symbol"||typeof arg==="undefined"}exports.isPrimitive=isPrimitive;function isBuffer(arg){return arg&&typeof arg==="object"&&typeof arg.copy==="function"&&typeof arg.fill==="function"&&typeof arg.binarySlice==="function"}exports.isBuffer=isBuffer;function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var d=new Date;var time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))};exports.inherits=function(ctor,superCtor){ctor.super_=superCtor;ctor.prototype=shims.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})};exports._extend=function(origin,add){if(!add||!isObject(add))return origin;var keys=shims.keys(add);var i=keys.length;while(i--){origin[keys[i]]=add[keys[i]]}return origin};function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}},{_shims:2}],6:[function(require,module,exports){var process=module.exports={};process.nextTick=function(){var canSetImmediate=typeof window!=="undefined"&&window.setImmediate;var canPost=typeof window!=="undefined"&&window.postMessage&&window.addEventListener;if(canSetImmediate){return function(f){return window.setImmediate(f)}}if(canPost){var queue=[];window.addEventListener("message",function(ev){if(ev.source===window&&ev.data==="process-tick"){ev.stopPropagation();if(queue.length>0){var fn=queue.shift();fn()}}},true);return function nextTick(fn){queue.push(fn);window.postMessage("process-tick","*")}}return function nextTick(fn){setTimeout(fn,0)}}();process.title="browser";process.browser=true;process.env={};process.argv=[];process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")}},{}],7:[function(require,module,exports){var utils=require("./utils"),path=require("path"),basename=path.basename,dirname=path.dirname,extname=path.extname,join=path.join,fs=require("fs"),read=fs.readFileSync;var filters=exports.filters=require("./filters");var cache={};exports.clearCache=function(){cache={}};function filtered(js){return js.substr(1).split("|").reduce(function(js,filter){var parts=filter.split(":"),name=parts.shift(),args=parts.join(":")||"";if(args)args=", "+args;return"filters."+name+"("+js+args+")"})}function rethrow(err,str,filename,lineno){var lines=str.split("\n"),start=Math.max(lineno-3,0),end=Math.min(lines.length,lineno+3);var context=lines.slice(start,end).map(function(line,i){var curr=i+start+1;return(curr==lineno?" >> ":"    ")+curr+"| "+line}).join("\n");err.path=filename;err.message=(filename||"ejs")+":"+lineno+"\n"+context+"\n\n"+err.message;throw err}var parse=exports.parse=function(str,options){var options=options||{},open=options.open||exports.open||"<%",close=options.close||exports.close||"%>",filename=options.filename,compileDebug=options.compileDebug!==false,buf=[];buf.push("var buf = [];");if(false!==options._with)buf.push("\nwith (locals || {}) { (function(){ ");buf.push("\n buf.push('");var lineno=1;var consumeEOL=false;for(var i=0,len=str.length;i<len;++i){if(str.slice(i,open.length+i)==open){i+=open.length;var prefix,postfix,line=(compileDebug?"__stack.lineno=":"")+lineno;switch(str.substr(i,1)){case"=":prefix="', escape(("+line+", ";postfix=")), '";++i;break;case"-":prefix="', ("+line+", ";postfix="), '";++i;break;default:prefix="');"+line+";";postfix="; buf.push('"}var end=str.indexOf(close,i),js=str.substring(i,end),start=i,include=null,n=0;if("-"==js[js.length-1]){js=js.substring(0,js.length-2);consumeEOL=true}if(0==js.trim().indexOf("include")){var name=js.trim().slice(7).trim();if(!filename)throw new Error("filename option is required for includes");var path=resolveInclude(name,filename);include=read(path,"utf8");include=exports.parse(include,{filename:path,_with:false,open:open,close:close,compileDebug:compileDebug});buf.push("' + (function(){"+include+"})() + '");js=""}while(~(n=js.indexOf("\n",n)))n++,lineno++;if(js.substr(0,1)==":")js=filtered(js);if(js){if(js.lastIndexOf("//")>js.lastIndexOf("\n"))js+="\n";buf.push(prefix,js,postfix)}i+=end-start+close.length-1}else if(str.substr(i,1)=="\\"){buf.push("\\\\")}else if(str.substr(i,1)=="'"){buf.push("\\'")}else if(str.substr(i,1)=="\r"){}else if(str.substr(i,1)=="\n"){if(consumeEOL){consumeEOL=false}else{buf.push("\\n");lineno++}}else{buf.push(str.substr(i,1))}}if(false!==options._with)buf.push("'); })();\n} \nreturn buf.join('');");else buf.push("');\nreturn buf.join('');");return buf.join("")};var compile=exports.compile=function(str,options){options=options||{};var escape=options.escape||utils.escape;var input=JSON.stringify(str),compileDebug=options.compileDebug!==false,client=options.client,filename=options.filename?JSON.stringify(options.filename):"undefined";if(compileDebug){str=["var __stack = { lineno: 1, input: "+input+", filename: "+filename+" };",rethrow.toString(),"try {",exports.parse(str,options),"} catch (err) {","  rethrow(err, __stack.input, __stack.filename, __stack.lineno);","}"].join("\n")}else{str=exports.parse(str,options)}if(options.debug)console.log(str);if(client)str="escape = escape || "+escape.toString()+";\n"+str;try{var fn=new Function("locals, filters, escape",str)}catch(err){if("SyntaxError"==err.name){err.message+=options.filename?" in "+filename:" while compiling ejs"}throw err}if(client)return fn;return function(locals){return fn.call(this,locals,filters,escape)}};exports.render=function(str,options){var fn,options=options||{};if(options.cache){if(options.filename){fn=cache[options.filename]||(cache[options.filename]=compile(str,options))}else{throw new Error('"cache" option requires "filename".')}}else{fn=compile(str,options)}options.__proto__=options.locals;return fn.call(options.scope,options)};exports.renderFile=function(path,options,fn){var key=path+":string";if("function"==typeof options){fn=options,options={}}options.filename=path;var str;try{str=options.cache?cache[key]||(cache[key]=read(path,"utf8")):read(path,"utf8")}catch(err){fn(err);return}fn(null,exports.render(str,options))};function resolveInclude(name,filename){var path=join(dirname(filename),name);var ext=extname(name);if(!ext)path+=".ejs";return path}exports.__express=exports.renderFile;if(require.extensions){require.extensions[".ejs"]=function(module,filename){filename=filename||module.filename;var options={filename:filename,client:true},template=fs.readFileSync(filename).toString(),fn=compile(template,options);module._compile("module.exports = "+fn.toString()+";",filename)}}else if(require.registerExtension){require.registerExtension(".ejs",function(src){return compile(src,{})})}},{"./filters":8,"./utils":9,fs:3,path:4}],8:[function(require,module,exports){exports.first=function(obj){return obj[0]};exports.last=function(obj){return obj[obj.length-1]};exports.capitalize=function(str){str=String(str);return str[0].toUpperCase()+str.substr(1,str.length)};exports.downcase=function(str){return String(str).toLowerCase()};exports.upcase=function(str){return String(str).toUpperCase()};exports.sort=function(obj){return Object.create(obj).sort()};exports.sort_by=function(obj,prop){return Object.create(obj).sort(function(a,b){a=a[prop],b=b[prop];if(a>b)return 1;if(a<b)return-1;return 0})};exports.size=exports.length=function(obj){return obj.length};exports.plus=function(a,b){return Number(a)+Number(b)};exports.minus=function(a,b){return Number(a)-Number(b)};exports.times=function(a,b){return Number(a)*Number(b)};exports.divided_by=function(a,b){return Number(a)/Number(b)};exports.join=function(obj,str){return obj.join(str||", ")};exports.truncate=function(str,len){str=String(str);return str.substr(0,len)};exports.truncate_words=function(str,n){var str=String(str),words=str.split(/ +/);return words.slice(0,n).join(" ")};exports.replace=function(str,pattern,substitution){return String(str).replace(pattern,substitution||"")};exports.prepend=function(obj,val){return Array.isArray(obj)?[val].concat(obj):val+obj};exports.append=function(obj,val){return Array.isArray(obj)?obj.concat(val):obj+val};exports.map=function(arr,prop){return arr.map(function(obj){return obj[prop]})};exports.reverse=function(obj){return Array.isArray(obj)?obj.reverse():String(obj).split("").reverse().join("")};exports.get=function(obj,prop){return obj[prop]};exports.json=function(obj){return JSON.stringify(obj)}},{}],9:[function(require,module,exports){exports.escape=function(html){return String(html).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}},{}],10:[function(require,module,exports){(function(){var root=this;var previousUnderscore=root._;var breaker={};var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind;var _=function(obj){if(obj instanceof _)return obj;if(!(this instanceof _))return new _(obj);this._wrapped=obj};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=_}exports._=_}else{root._=_}_.VERSION="1.5.2";var each=_.each=_.forEach=function(obj,iterator,context){if(obj==null)return;if(nativeForEach&&obj.forEach===nativeForEach){obj.forEach(iterator,context)}else if(obj.length===+obj.length){for(var i=0,length=obj.length;i<length;i++){if(iterator.call(context,obj[i],i,obj)===breaker)return}}else{var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++){if(iterator.call(context,obj[keys[i]],keys[i],obj)===breaker)return}}};_.map=_.collect=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeMap&&obj.map===nativeMap)return obj.map(iterator,context);each(obj,function(value,index,list){results.push(iterator.call(context,value,index,list))});return results};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduce&&obj.reduce===nativeReduce){if(context)iterator=_.bind(iterator,context);return initial?obj.reduce(iterator,memo):obj.reduce(iterator)}each(obj,function(value,index,list){if(!initial){memo=value;initial=true}else{memo=iterator.call(context,memo,value,index,list)}});if(!initial)throw new TypeError(reduceError);return memo};_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduceRight&&obj.reduceRight===nativeReduceRight){if(context)iterator=_.bind(iterator,context);return initial?obj.reduceRight(iterator,memo):obj.reduceRight(iterator)}var length=obj.length;if(length!==+length){var keys=_.keys(obj);length=keys.length}each(obj,function(value,index,list){index=keys?keys[--length]:--length;if(!initial){memo=obj[index];initial=true}else{memo=iterator.call(context,memo,obj[index],index,list)}});if(!initial)throw new TypeError(reduceError);return memo};_.find=_.detect=function(obj,iterator,context){var result;any(obj,function(value,index,list){if(iterator.call(context,value,index,list)){result=value;return true}});return result};_.filter=_.select=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeFilter&&obj.filter===nativeFilter)return obj.filter(iterator,context);each(obj,function(value,index,list){if(iterator.call(context,value,index,list))results.push(value)});return results};_.reject=function(obj,iterator,context){return _.filter(obj,function(value,index,list){return!iterator.call(context,value,index,list)},context)};_.every=_.all=function(obj,iterator,context){iterator||(iterator=_.identity);var result=true;if(obj==null)return result;if(nativeEvery&&obj.every===nativeEvery)return obj.every(iterator,context);each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list)))return breaker});return!!result};var any=_.some=_.any=function(obj,iterator,context){iterator||(iterator=_.identity);var result=false;if(obj==null)return result;if(nativeSome&&obj.some===nativeSome)return obj.some(iterator,context);each(obj,function(value,index,list){if(result||(result=iterator.call(context,value,index,list)))return breaker});return!!result};_.contains=_.include=function(obj,target){if(obj==null)return false;if(nativeIndexOf&&obj.indexOf===nativeIndexOf)return obj.indexOf(target)!=-1;return any(obj,function(value){return value===target})};_.invoke=function(obj,method){var args=slice.call(arguments,2);var isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})};_.pluck=function(obj,key){return _.map(obj,function(value){return value[key]})};_.where=function(obj,attrs,first){if(_.isEmpty(attrs))return first?void 0:[];return _[first?"find":"filter"](obj,function(value){for(var key in attrs){if(attrs[key]!==value[key])return false}return true})};_.findWhere=function(obj,attrs){return _.where(obj,attrs,true)};_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.max.apply(Math,obj)}if(!iterator&&_.isEmpty(obj))return-Infinity;var result={computed:-Infinity,value:-Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>result.computed&&(result={value:value,computed:computed})});return result.value};_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.min.apply(Math,obj)}if(!iterator&&_.isEmpty(obj))return Infinity;var result={computed:Infinity,value:Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed})});return result.value};_.shuffle=function(obj){var rand;var index=0;var shuffled=[];each(obj,function(value){rand=_.random(index++);shuffled[index-1]=shuffled[rand];shuffled[rand]=value});return shuffled};_.sample=function(obj,n,guard){if(arguments.length<2||guard){return obj[_.random(obj.length-1)]}return _.shuffle(obj).slice(0,Math.max(0,n))};var lookupIterator=function(value){return _.isFunction(value)?value:function(obj){return obj[value]}};_.sortBy=function(obj,value,context){var iterator=lookupIterator(value);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,value,context){var result={};var iterator=value==null?_.identity:lookupIterator(value);each(obj,function(value,index){var key=iterator.call(context,value,index,obj);behavior(result,key,value)});return result}};_.groupBy=group(function(result,key,value){(_.has(result,key)?result[key]:result[key]=[]).push(value)});_.indexBy=group(function(result,key,value){result[key]=value});_.countBy=group(function(result,key){_.has(result,key)?result[key]++:result[key]=1});_.sortedIndex=function(array,obj,iterator,context){iterator=iterator==null?_.identity:lookupIterator(iterator);var value=iterator.call(context,obj);var low=0,high=array.length;while(low<high){var mid=low+high>>>1;iterator.call(context,array[mid])<value?low=mid+1:high=mid}return low};_.toArray=function(obj){if(!obj)return[];if(_.isArray(obj))return slice.call(obj);if(obj.length===+obj.length)return _.map(obj,_.identity);return _.values(obj)};_.size=function(obj){if(obj==null)return 0;return obj.length===+obj.length?obj.length:_.keys(obj).length};_.first=_.head=_.take=function(array,n,guard){if(array==null)return void 0;return n==null||guard?array[0]:slice.call(array,0,n)};_.initial=function(array,n,guard){return slice.call(array,0,array.length-(n==null||guard?1:n))};_.last=function(array,n,guard){if(array==null)return void 0;if(n==null||guard){return array[array.length-1]}else{return slice.call(array,Math.max(array.length-n,0))}};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,n==null||guard?1:n)};_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,output){if(shallow&&_.every(input,_.isArray)){return concat.apply(output,input)}each(input,function(value){if(_.isArray(value)||_.isArguments(value)){shallow?push.apply(output,value):flatten(value,shallow,output)}else{output.push(value)}});return output};_.flatten=function(array,shallow){return flatten(array,shallow,[])};_.without=function(array){return _.difference(array,slice.call(arguments,1))};_.uniq=_.unique=function(array,isSorted,iterator,context){if(_.isFunction(isSorted)){context=iterator;iterator=isSorted;isSorted=false}var initial=iterator?_.map(array,iterator,context):array;var results=[];var seen=[];each(initial,function(value,index){if(isSorted?!index||seen[seen.length-1]!==value:!_.contains(seen,value)){seen.push(value);results.push(array[index])}});return results};_.union=function(){return _.uniq(_.flatten(arguments,true))};_.intersection=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0})})};_.difference=function(array){var rest=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(array,function(value){return!_.contains(rest,value)})};_.zip=function(){var length=_.max(_.pluck(arguments,"length").concat(0));var results=new Array(length);for(var i=0;i<length;i++){results[i]=_.pluck(arguments,""+i)}return results};_.object=function(list,values){if(list==null)return{};var result={};for(var i=0,length=list.length;i<length;i++){if(values){result[list[i]]=values[i]}else{result[list[i][0]]=list[i][1]}}return result};_.indexOf=function(array,item,isSorted){if(array==null)return-1;var i=0,length=array.length;if(isSorted){if(typeof isSorted=="number"){i=isSorted<0?Math.max(0,length+isSorted):isSorted}else{i=_.sortedIndex(array,item);return array[i]===item?i:-1}}if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item,isSorted);for(;i<length;i++)if(array[i]===item)return i;return-1};_.lastIndexOf=function(array,item,from){if(array==null)return-1;var hasIndex=from!=null;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf){return hasIndex?array.lastIndexOf(item,from):array.lastIndexOf(item)}var i=hasIndex?from:array.length;while(i--)if(array[i]===item)return i;return-1};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0}step=arguments[2]||1;var length=Math.max(Math.ceil((stop-start)/step),0);var idx=0;var range=new Array(length);while(idx<length){range[idx++]=start;start+=step}return range};var ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;args=slice.call(arguments,2);return bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));ctor.prototype=func.prototype;var self=new ctor;ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));if(Object(result)===result)return result;return self}};_.partial=function(func){var args=slice.call(arguments,1);return function(){return func.apply(this,args.concat(slice.call(arguments)))}};_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(funcs.length===0)throw new Error("bindAll must be passed function names");each(funcs,function(f){obj[f]=_.bind(obj[f],obj)});return obj};_.memoize=function(func,hasher){var memo={};hasher||(hasher=_.identity);return function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)};_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))};_.throttle=function(func,wait,options){var context,args,result;var timeout=null;var previous=0;options||(options={});var later=function(){previous=options.leading===false?0:new Date;timeout=null;result=func.apply(context,args)};return function(){var now=new Date;if(!previous&&options.leading===false)previous=now;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0){clearTimeout(timeout);timeout=null;previous=now;result=func.apply(context,args)}else if(!timeout&&options.trailing!==false){timeout=setTimeout(later,remaining)}return result}};_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result;return function(){context=this;args=arguments;timestamp=new Date;var later=function(){var last=new Date-timestamp;if(last<wait){timeout=setTimeout(later,wait-last)}else{timeout=null;if(!immediate)result=func.apply(context,args)}};var callNow=immediate&&!timeout;if(!timeout){timeout=setTimeout(later,wait)}if(callNow)result=func.apply(context,args);return result}};_.once=function(func){var ran=false,memo;return function(){if(ran)return memo;ran=true;memo=func.apply(this,arguments);func=null;return memo}};_.wrap=function(func,wrapper){return function(){var args=[func];push.apply(args,arguments);return wrapper.apply(this,args)}};_.compose=function(){var funcs=arguments;return function(){var args=arguments;for(var i=funcs.length-1;i>=0;i--){args=[funcs[i].apply(this,args)]}return args[0]}};_.after=function(times,func){return function(){if(--times<1){return func.apply(this,arguments)}}};_.keys=nativeKeys||function(obj){if(obj!==Object(obj))throw new TypeError("Invalid object");var keys=[];for(var key in obj)if(_.has(obj,key))keys.push(key);return keys};_.values=function(obj){var keys=_.keys(obj);var length=keys.length;var values=new Array(length);for(var i=0;i<length;i++){values[i]=obj[keys[i]]}return values};_.pairs=function(obj){var keys=_.keys(obj);var length=keys.length;var pairs=new Array(length);for(var i=0;i<length;i++){pairs[i]=[keys[i],obj[keys[i]]]}return pairs};_.invert=function(obj){var result={};var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++){result[obj[keys[i]]]=keys[i]}return result};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key]))names.push(key)}return names.sort()};_.extend=function(obj){each(slice.call(arguments,1),function(source){if(source){for(var prop in source){obj[prop]=source[prop]
}}});return obj};_.pick=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));each(keys,function(key){if(key in obj)copy[key]=obj[key]});return copy};_.omit=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));for(var key in obj){if(!_.contains(keys,key))copy[key]=obj[key]}return copy};_.defaults=function(obj){each(slice.call(arguments,1),function(source){if(source){for(var prop in source){if(obj[prop]===void 0)obj[prop]=source[prop]}}});return obj};_.clone=function(obj){if(!_.isObject(obj))return obj;return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};var eq=function(a,b,aStack,bStack){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;if(a instanceof _)a=a._wrapped;if(b instanceof _)b=b._wrapped;var className=toString.call(a);if(className!=toString.call(b))return false;switch(className){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return false;var length=aStack.length;while(length--){if(aStack[length]==a)return bStack[length]==b}var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)){return false}aStack.push(a);bStack.push(b);var size=0,result=true;if(className=="[object Array]"){size=a.length;result=size==b.length;if(result){while(size--){if(!(result=eq(a[size],b[size],aStack,bStack)))break}}}else{for(var key in a){if(_.has(a,key)){size++;if(!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack)))break}}if(result){for(key in b){if(_.has(b,key)&&!size--)break}result=!size}}aStack.pop();bStack.pop();return result};_.isEqual=function(a,b){return eq(a,b,[],[])};_.isEmpty=function(obj){if(obj==null)return true;if(_.isArray(obj)||_.isString(obj))return obj.length===0;for(var key in obj)if(_.has(obj,key))return false;return true};_.isElement=function(obj){return!!(obj&&obj.nodeType===1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)=="[object Array]"};_.isObject=function(obj){return obj===Object(obj)};each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)=="[object "+name+"]"}});if(!_.isArguments(arguments)){_.isArguments=function(obj){return!!(obj&&_.has(obj,"callee"))}}if(typeof/./!=="function"){_.isFunction=function(obj){return typeof obj==="function"}}_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))};_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)=="[object Boolean]"};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.has=function(obj,key){return hasOwnProperty.call(obj,key)};_.noConflict=function(){root._=previousUnderscore;return this};_.identity=function(value){return value};_.times=function(n,iterator,context){var accum=Array(Math.max(0,n));for(var i=0;i<n;i++)accum[i]=iterator.call(context,i);return accum};_.random=function(min,max){if(max==null){max=min;min=0}return min+Math.floor(Math.random()*(max-min+1))};var entityMap={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};entityMap.unescape=_.invert(entityMap.escape);var entityRegexes={escape:new RegExp("["+_.keys(entityMap.escape).join("")+"]","g"),unescape:new RegExp("("+_.keys(entityMap.unescape).join("|")+")","g")};_.each(["escape","unescape"],function(method){_[method]=function(string){if(string==null)return"";return(""+string).replace(entityRegexes[method],function(match){return entityMap[method][match]})}});_.result=function(object,property){if(object==null)return void 0;var value=object[property];return _.isFunction(value)?value.call(object):value};_.mixin=function(obj){each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result.call(this,func.apply(_,args))}})};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"};var escaper=/\\|'|\r|\n|\t|\u2028|\u2029/g;_.template=function(text,data,settings){var render;settings=_.defaults({},settings,_.templateSettings);var matcher=new RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g");var index=0;var source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,function(match){return"\\"+escapes[match]});if(escape){source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'"}if(interpolate){source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'"}if(evaluate){source+="';\n"+evaluate+"\n__p+='"}index=offset+match.length;return match});source+="';\n";if(!settings.variable)source="with(obj||{}){\n"+source+"}\n";source="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{render=new Function(settings.variable||"obj","_",source)}catch(e){e.source=source;throw e}if(data)return render(data,_);var template=function(data){return render.call(this,data,_)};template.source="function("+(settings.variable||"obj")+"){\n"+source+"}";return template};_.chain=function(obj){return _(obj).chain()};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin(_);each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name=="shift"||name=="splice")&&obj.length===0)delete obj[0];return result.call(this,obj)}});each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}});_.extend(_.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this)},{}],app:[function(require,module,exports){module.exports=require("bvY2c9")},{}],bvY2c9:[function(require,module,exports){var global=typeof self!=="undefined"?self:typeof window!=="undefined"?window:{};"use strict";var routers=require("./routers/index"),Backbone=require("./backbone/backbone-modified");var startApp=function(backBoneOptions){backBoneOptions=backBoneOptions||{};var menu=new Backbone.AnywhereView({el:global.$(".layout.fixed")[0]});for(var i in routers){var dummy=new routers[i]}if(global.ONSERVER){return}backBoneOptions.pushState=true;Backbone.history.start(backBoneOptions)};module.exports=startApp},{"./backbone/backbone-modified":13,"./routers/index":23}],13:[function(require,module,exports){var global=typeof self!=="undefined"?self:typeof window!=="undefined"?window:{};"use strict";var _=require("underscore"),renderEngine=require("ejs"),Backbone=require("backbone");if(global.ONCLIENT){global._=_;global.Backbone=Backbone;require("./backbone-urlhandler")}Backbone.AnywhereModel=Backbone.Model.extend({urlRoot:"/api/",url:function(){var base=this.urlRoot+this.type+"/";if(this.isNew()){return base}return base+encodeURIComponent(this.id)}});Backbone.AnywhereCollection=Backbone.Collection.extend({urlRoot:"/api/",url:function(models){return this.urlRoot+this.type+(models?"/set/"+_.pluck(models,"id").join(";")+"/":"/")},dateCreated:null,dateModified:null,orderBy:"dateModified",orderDir:"desc",fetch:function(options){options=options||{};var sort=options.sort||null;sort&&sort.by&&(this.orderBy=sort.by);sort&&sort.dir&&(this.orderDir=sort.dir);sort&&sort.limit&&(this.limit=sort.limit.split("-"));options.sort={by:this.orderBy,dir:this.orderDir,limit:this.limit};return Backbone.Collection.prototype.fetch.call(this,options)},comparator:function(item){var orderBy=item.collection.orderBy||item.collection.prototype.orderBy;var dir=(item.collection.orderDir||item.collection.prototype.orderDir).toLowerCase();var val=item.get(orderBy);if(_.isBoolean(val)){return val?dir==="asc"?1:-1:0}if(_.isNumber(val)){return dir==="asc"?val:-val}if(dir==="asc"){return val}return String.fromCharCode.apply(String,_.map(val.split(""),function(c){return 65535-c.charCodeAt()}))}});var viewOptions=["model","collection","el","id","attributes","className","tagName","events"];Backbone.AnywhereView=Backbone.View.extend({constructor:function(options){this.cid=_.uniqueId("view");_.extend(this,_.pick(options,viewOptions));this._ensureElement();this.events=this.events||{};_.extend(this.events,Backbone.View.prototype.events);if(this.template){var data=this.model&&this.model.toJSON()||this.collection&&this.collection.toJSON()||{};this.$el.html(this.template(data))}if(global.ONCLIENT){this.delegateEvents()}this.initialize.apply(this,arguments)},renderEngine:renderEngine,show:function(){this.$el.css("display","block")},hide:function(){this.$el.css("display","none")}});Backbone.createViewCallback=function(view){return function(){Backbone.onlyShowLayout(view);if(global.ONSERVER){global.sendFullHtmlToClient()}}};Backbone.onlyShowLayout=function(layoutToShow){global.$(".layout:not(.fixed)").css("display","none");layoutToShow.show()};module.exports=Backbone},{"./backbone-urlhandler":14,backbone:1,ejs:7,underscore:10}],14:[function(require,module,exports){var _=require("underscore");var Backbone=require("backbone");var view=Backbone.View;view.prototype.events={"click a.noscroll":"routeClickNoScroll","click a:not(.noscroll)":"routeClick"};view.prototype.routeClickNoScroll=function(ev){return this.routeClick(ev,true)};view.prototype.routeClick=function(ev,noscroll){if(_.size(window.currentKeys)){return true}var href=this.normalizeHREF($(ev.currentTarget).get(0).getAttribute("href",2));if(href){return this.route(href,noscroll)}return true};view.prototype.normalizeHREF=function(href){var docMode=document.documentMode;var oldIE=$.browser.msie&&(!docMode||docMode<=7);if(oldIE){var url=/^https?:\/\/([^/]+)(\/.*)$/.exec(href);if(!url||url<3){return false}var href=url.pop(),domain=url.pop();if(window.location.host!=domain){return false}if(href.indexOf("/#")===0){href=href.substr(1)}}return href};view.prototype.route=function(path,noscroll){if(path==="#"||path==="/#!"){return false}var that=this;if(path.charAt(0)==="/"){path=path.substr(1);var matched=_.any(Backbone.history.handlers,function(handler){if(handler.route.test(path)){Backbone.history.navigate(path);noscroll||that.scrollTop();handler.callback(path);return true}});return!matched}return true};view.prototype.scrollTop=function(){if($("body").scrollTop()){$("body").animate({scrollTop:0});return}if($("html").scrollTop()){$("html").animate({scrollTop:0});return}};module.exports=Backbone.View},{backbone:1,underscore:10}],15:[function(require,module,exports){var global=window||global;global.ROOT="/js/";global.ONSERVER=!window;global.ONCLIENT=!!window;var app=require("./app");$(document).ready(app)},{"./app":"bvY2c9"}],16:[function(require,module,exports){"use strict";var Backbone=require("../backbone/backbone-modified"),SongModel=require("./SongModel");module.exports=Backbone.AnywhereCollection.extend({type:"songs",model:SongModel,orderBy:"title",published:function(){return this.filter(function(song){return song.get("published")})},remaining:function(){return this.without.apply(this,this.published())},nextOrder:function(){if(!this.length)return 1;return this.last().get("order")+1}})},{"../backbone/backbone-modified":13,"./SongModel":17}],17:[function(require,module,exports){"use strict";var Backbone=require("../backbone/backbone-modified");module.exports=Backbone.AnywhereModel.extend({type:"songs",defaults:{id:null,title:"",published:false,authorId:1,groupId:1},initialize:function(){this.bind("remove",this._removeView,this);this.bind("destroy",this._removeView,this)},toggle:function(){this.save({published:!this.get("published")})},_removeView:function(){if(this.view&&!this.view.removing){this.view.remove(false)}}})},{"../backbone/backbone-modified":13}],18:[function(require,module,exports){"use strict";var Backbone=require("../backbone/backbone-modified"),TrackModel=require("./TrackModel");module.exports=Backbone.AnywhereCollection.extend({type:"tracks",model:TrackModel,orderBy:"title",published:function(){return this.filter(function(track){return track.get("published")})},remaining:function(){return this.without.apply(this,this.published())},nextOrder:function(){if(!this.length)return 1;return this.last().get("order")+1}})},{"../backbone/backbone-modified":13,"./TrackModel":19}],19:[function(require,module,exports){"use strict";var Backbone=require("../backbone/backbone-modified");module.exports=Backbone.AnywhereModel.extend({type:"tracks",defaults:{id:null,title:"",author:"john doe",source:"/sample.aac",published:false,authorId:1,groupId:1},initialize:function(){this.bind("remove",this._removeView,this);this.bind("destroy",this._removeView,this)},toggle:function(){this.save({published:!this.get("published")})},_removeView:function(){if(this.view&&!this.view.removing){this.view.remove(false)}}})},{"../backbone/backbone-modified":13}],20:[function(require,module,exports){"use strict";module.exports={Song:require("./SongModel"),SongCollection:require("./SongCollection"),Track:require("./TrackModel"),TrackCollection:require("./TrackCollection")}},{"./SongCollection":16,"./SongModel":17,"./TrackCollection":18,"./TrackModel":19}],21:[function(require,module,exports){"use strict";var _=require("underscore"),views=require("../views/index"),models=require("../models/index"),Backbone=require("../backbone/backbone-modified");module.exports=Backbone.Router.extend({routes:{"":"songList","songs/":"songList","songs/by/:orderBy/dir/:dir/limit/:limit":"songList","songs/by/:orderBy/dir/:dir":"songList","songs/by/:orderBy":"songList","songs/:id":"song"},songList:function(orderBy,dir,limit){var viewCallback;if(!this.songListView){this.songListView=new views.SongList({collection:new models.SongCollection})}viewCallback=Backbone.createViewCallback(this.songListView);this.songListView.collection.fetch({sort:{by:orderBy,dir:dir||"asc",limit:limit},success:viewCallback,error:viewCallback})},song:function(id){var viewCallback;id=parseInt(id,10);if(!this.songView){this.songView=new views.Song({model:new models.Song({id:id})})}else{this.songView.model.set("id",id)}viewCallback=Backbone.createViewCallback(this.songView);this.songView.model.fetch({success:viewCallback,error:viewCallback})}})},{"../backbone/backbone-modified":13,"../models/index":20,"../views/index":38,underscore:10}],22:[function(require,module,exports){"use strict";var _=require("underscore"),views=require("../views/index"),models=require("../models/index"),Backbone=require("../backbone/backbone-modified");module.exports=Backbone.Router.extend({routes:{"tracks/":"trackList","tracks/by/:orderBy/dir/:dir/limit/:limit":"trackList","tracks/by/:orderBy/dir/:dir":"trackList","tracks/by/:orderBy":"trackList","tracks/:id":"track"},trackList:function(orderBy,dir,limit){var viewCallback;if(!this.trackListView){this.trackListView=new views.TrackList({collection:new models.TrackCollection})}viewCallback=Backbone.createViewCallback(this.trackListView);this.trackListView.collection.fetch({sort:{by:orderBy,dir:dir||"asc",limit:limit},success:viewCallback,error:viewCallback})},track:function(id){var viewCallback;id=parseInt(id,10);if(!this.trackView){this.trackView=new views.Track({model:new models.Track({id:id})})}else{this.trackView.model.set("id",id)}viewCallback=Backbone.createViewCallback(this.trackView);this.trackView.model.fetch({success:viewCallback,error:viewCallback})}})},{"../backbone/backbone-modified":13,"../models/index":20,"../views/index":38,underscore:10}],23:[function(require,module,exports){if(typeof module==="undefined"){module={}}module.exports={Song:require("./SongRouter"),Track:require("./TrackRouter")}},{"./SongRouter":21,"./TrackRouter":22}],24:[function(require,module,exports){module.exports=function anonymous(locals,filters,escape){escape=escape||function(html){return String(html).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var __stack={lineno:1,input:'<!-- Song View -->\n<div class="title">\n    <h1>Song Details</h1>\n</div>\n<div class="content">\n    <div class="song">\n        <div class="content">\n            Title: <span class="display title"><%= title %></span><span class="edit"><input class="input title" type="text" value="<%= title %>" /></span><br/>\n            Checked: <span class="display published"><%= published %></span><span class="edit"><input class="input published" type="text" value="<%= published %>" /></span>\n        </div>\n    </div>\n    <div class="tracklist-subview"><!-- INCLUDE trackList.ejs --></div>\n</div>\n',filename:"/Users/MoDrama/Documents/workspace/backbone-revisited/public/js/templates/song.ejs"};function rethrow(err,str,filename,lineno){var lines=str.split("\n"),start=Math.max(lineno-3,0),end=Math.min(lines.length,lineno+3);var context=lines.slice(start,end).map(function(line,i){var curr=i+start+1;return(curr==lineno?" >> ":"    ")+curr+"| "+line}).join("\n");err.path=filename;err.message=(filename||"ejs")+":"+lineno+"\n"+context+"\n\n"+err.message;throw err}try{var buf=[];with(locals||{}){(function(){buf.push('<!-- Song View -->\n<div class="title">\n    <h1>Song Details</h1>\n</div>\n<div class="content">\n    <div class="song">\n        <div class="content">\n            Title: <span class="display title">',escape((__stack.lineno=8,title)),'</span><span class="edit"><input class="input title" type="text" value="',escape((__stack.lineno=8,title)),'" /></span><br/>\n            Checked: <span class="display published">',escape((__stack.lineno=9,published)),'</span><span class="edit"><input class="input published" type="text" value="',escape((__stack.lineno=9,published)),'" /></span>\n        </div>\n    </div>\n    <div class="tracklist-subview"><!-- INCLUDE trackList.ejs --></div>\n</div>\n')})()}return buf.join("")}catch(err){rethrow(err,__stack.input,__stack.filename,__stack.lineno)}}},{}],25:[function(require,module,exports){module.exports=function anonymous(locals,filters,escape){escape=escape||function(html){return String(html).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var __stack={lineno:1,input:'<!-- SongList View -->\n<div class="title">\n    <h1>Song List</h1>\n</div>\n<div class="content">\n    <div class="create">\n        <input class="song-new" placeholder="Song title?" type="text" /><span class="ui-tooltip-top" style="display:none;">Press Enter to save as a new Song</span>\n    </div>\n    <div><ul class="songlist"><!-- INCLUDE songListItem.ejs --></ul></div>\n    <div class="songlist-stats stats"><!-- INCLUDE songListStats.ejs --></div>\n</div>\n',filename:"/Users/MoDrama/Documents/workspace/backbone-revisited/public/js/templates/songlist.ejs"};function rethrow(err,str,filename,lineno){var lines=str.split("\n"),start=Math.max(lineno-3,0),end=Math.min(lines.length,lineno+3);var context=lines.slice(start,end).map(function(line,i){var curr=i+start+1;return(curr==lineno?" >> ":"    ")+curr+"| "+line}).join("\n");err.path=filename;err.message=(filename||"ejs")+":"+lineno+"\n"+context+"\n\n"+err.message;throw err}try{var buf=[];with(locals||{}){(function(){buf.push('<!-- SongList View -->\n<div class="title">\n    <h1>Song List</h1>\n</div>\n<div class="content">\n    <div class="create">\n        <input class="song-new" placeholder="Song title?" type="text" /><span class="ui-tooltip-top" style="display:none;">Press Enter to save as a new Song</span>\n    </div>\n    <div><ul class="songlist"><!-- INCLUDE songListItem.ejs --></ul></div>\n    <div class="songlist-stats stats"><!-- INCLUDE songListStats.ejs --></div>\n</div>\n')})()}return buf.join("")}catch(err){rethrow(err,__stack.input,__stack.filename,__stack.lineno)}}},{}],26:[function(require,module,exports){module.exports=function anonymous(locals,filters,escape){escape=escape||function(html){return String(html).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var __stack={lineno:1,input:'<div class="song <%= published ? \'published\' : \'\' %>">\n    <div class="display">\n        <input class="song-check check" type="checkbox"<%= published ? \'checked="checked"\' : \'\' %>/>\n        <div class="song-content">\n            <a href="/songs/<%= id %>"><%= title %></a>\n        </div>\n        <span class="song-destroy destroy"></span>\n    </div>\n    <div class="edit">\n        <input class="song-input" type="text" value="<%= title %>" />\n    </div>\n</div>',filename:"/Users/MoDrama/Documents/workspace/backbone-revisited/public/js/templates/songlistItem.ejs"};function rethrow(err,str,filename,lineno){var lines=str.split("\n"),start=Math.max(lineno-3,0),end=Math.min(lines.length,lineno+3);var context=lines.slice(start,end).map(function(line,i){var curr=i+start+1;return(curr==lineno?" >> ":"    ")+curr+"| "+line}).join("\n");err.path=filename;err.message=(filename||"ejs")+":"+lineno+"\n"+context+"\n\n"+err.message;throw err}try{var buf=[];with(locals||{}){(function(){buf.push('<div class="song ',escape((__stack.lineno=1,published?"published":"")),'">\n    <div class="display">\n        <input class="song-check check" type="checkbox"',escape((__stack.lineno=3,published?'checked="checked"':"")),'/>\n        <div class="song-content">\n            <a href="/songs/',escape((__stack.lineno=5,id)),'">',escape((__stack.lineno=5,title)),'</a>\n        </div>\n        <span class="song-destroy destroy"></span>\n    </div>\n    <div class="edit">\n        <input class="song-input" type="text" value="',escape((__stack.lineno=10,title)),'" />\n    </div>\n</div>')})()}return buf.join("")}catch(err){rethrow(err,__stack.input,__stack.filename,__stack.lineno)}}},{}],27:[function(require,module,exports){module.exports=function anonymous(locals,filters,escape){escape=escape||function(html){return String(html).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var __stack={lineno:1,input:'<% if (total) { %>\n    <span class="count">\n        <span class="number"><%= remaining %></span>\n        <span class="word"><%= remaining == 1 ? \'item\' : \'items\' %></span> left.\n    </span>\n<% } %>\n<% if (published) { %>\n    <span class="song clear">\n        <a href="#">\n            Clear<span class="number-done"> <%= published %></span>\n            checked <span class="word-done"><%= published == 1 ? \'item\' : \'items\' %></span>\n        </a>\n    </span>\n<% } %>\n',filename:"/Users/MoDrama/Documents/workspace/backbone-revisited/public/js/templates/songlistStats.ejs"};function rethrow(err,str,filename,lineno){var lines=str.split("\n"),start=Math.max(lineno-3,0),end=Math.min(lines.length,lineno+3);var context=lines.slice(start,end).map(function(line,i){var curr=i+start+1;return(curr==lineno?" >> ":"    ")+curr+"| "+line}).join("\n");err.path=filename;err.message=(filename||"ejs")+":"+lineno+"\n"+context+"\n\n"+err.message;throw err}try{var buf=[];with(locals||{}){(function(){buf.push("");__stack.lineno=1;if(total){buf.push('\n    <span class="count">\n        <span class="number">',escape((__stack.lineno=3,remaining)),'</span>\n        <span class="word">',escape((__stack.lineno=4,remaining==1?"item":"items")),"</span> left.\n    </span>\n");__stack.lineno=6}buf.push("\n");__stack.lineno=7;if(published){buf.push('\n    <span class="song clear">\n        <a href="#">\n            Clear<span class="number-done"> ',escape((__stack.lineno=10,published)),'</span>\n            checked <span class="word-done">',escape((__stack.lineno=11,published==1?"item":"items")),"</span>\n        </a>\n    </span>\n");__stack.lineno=14}buf.push("\n")})()}return buf.join("")}catch(err){rethrow(err,__stack.input,__stack.filename,__stack.lineno)}}},{}],28:[function(require,module,exports){module.exports=function anonymous(locals,filters,escape){escape=escape||function(html){return String(html).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var __stack={lineno:1,input:'<!-- Track View -->\n<div class="title">\n    <h1>Track Details</h1>\n</div>\n<div class="content">\n    Author: <span class="display"><%= author %></span><br />\n    Title: <span class="display"><%= title %></span><span class="edit"><input class="input" type="text" value="<%= title %>" /></span><br/>\n    Published: <span class="display"><%= published %></span><span class="edit"><input class="input" type="text" value="<%= published %>" /></span><br />\n    Audio:\n    <audio controls="controls">\n        <source src="<%= source %>" type="audio/aac" />\n        Your browser does not support the audio element.\n    </audio>\n</div>\n',filename:"/Users/MoDrama/Documents/workspace/backbone-revisited/public/js/templates/track.ejs"};function rethrow(err,str,filename,lineno){var lines=str.split("\n"),start=Math.max(lineno-3,0),end=Math.min(lines.length,lineno+3);var context=lines.slice(start,end).map(function(line,i){var curr=i+start+1;return(curr==lineno?" >> ":"    ")+curr+"| "+line}).join("\n");err.path=filename;err.message=(filename||"ejs")+":"+lineno+"\n"+context+"\n\n"+err.message;throw err}try{var buf=[];with(locals||{}){(function(){buf.push('<!-- Track View -->\n<div class="title">\n    <h1>Track Details</h1>\n</div>\n<div class="content">\n    Author: <span class="display">',escape((__stack.lineno=6,author)),'</span><br />\n    Title: <span class="display">',escape((__stack.lineno=7,title)),'</span><span class="edit"><input class="input" type="text" value="',escape((__stack.lineno=7,title)),'" /></span><br/>\n    Published: <span class="display">',escape((__stack.lineno=8,published)),'</span><span class="edit"><input class="input" type="text" value="',escape((__stack.lineno=8,published)),'" /></span><br />\n    Audio:\n    <audio controls="controls">\n        <source src="',escape((__stack.lineno=11,source)),'" type="audio/aac" />\n        Your browser does not support the audio element.\n    </audio>\n</div>\n')})()}return buf.join("")}catch(err){rethrow(err,__stack.input,__stack.filename,__stack.lineno)}}},{}],29:[function(require,module,exports){module.exports=function anonymous(locals,filters,escape){escape=escape||function(html){return String(html).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var __stack={lineno:1,input:'<!-- TrackList View -->\n<div class="title">\n    <h2>Track List</h2>\n</div>\n<div class="content">\n    <div class="create">\n        <input class="track-new" placeholder="Track title?" type="text" /><span class="ui-tooltip-top" style="display:none;">Press Enter to save as a new Track</span>\n    </div>\n    <div><ul class="tracklist"><!-- INCLUDE trackListItem.ejs --></ul></div>\n    <div class="tracklist-stats stats"><!-- INCLUDE trackListStats.ejs --></div>\n</div>\n',filename:"/Users/MoDrama/Documents/workspace/backbone-revisited/public/js/templates/tracklist.ejs"};function rethrow(err,str,filename,lineno){var lines=str.split("\n"),start=Math.max(lineno-3,0),end=Math.min(lines.length,lineno+3);var context=lines.slice(start,end).map(function(line,i){var curr=i+start+1;return(curr==lineno?" >> ":"    ")+curr+"| "+line}).join("\n");err.path=filename;err.message=(filename||"ejs")+":"+lineno+"\n"+context+"\n\n"+err.message;throw err}try{var buf=[];with(locals||{}){(function(){buf.push('<!-- TrackList View -->\n<div class="title">\n    <h2>Track List</h2>\n</div>\n<div class="content">\n    <div class="create">\n        <input class="track-new" placeholder="Track title?" type="text" /><span class="ui-tooltip-top" style="display:none;">Press Enter to save as a new Track</span>\n    </div>\n    <div><ul class="tracklist"><!-- INCLUDE trackListItem.ejs --></ul></div>\n    <div class="tracklist-stats stats"><!-- INCLUDE trackListStats.ejs --></div>\n</div>\n')})()}return buf.join("")}catch(err){rethrow(err,__stack.input,__stack.filename,__stack.lineno)}}},{}],30:[function(require,module,exports){module.exports=function anonymous(locals,filters,escape){escape=escape||function(html){return String(html).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var __stack={lineno:1,input:'<!-- TrackListItem View -->\n<div class="track <%= published ? \'published\' : \'\' %>">\n    <div class="display">\n        <input class="track-check check" type="checkbox"<%= published ? \'checked="checked"\' : \'\' %>/>\n        <div class="track-content">\n            <a href="/tracks/<%= id %>"><%= title %></a>\n        </div>\n        <span class="track-destroy destroy"></span>\n    </div>\n    <div class="edit">\n        <input class="track-input" type="text" value="<%= title %>" />\n    </div>\n</div>',filename:"/Users/MoDrama/Documents/workspace/backbone-revisited/public/js/templates/tracklistItem.ejs"};function rethrow(err,str,filename,lineno){var lines=str.split("\n"),start=Math.max(lineno-3,0),end=Math.min(lines.length,lineno+3);var context=lines.slice(start,end).map(function(line,i){var curr=i+start+1;return(curr==lineno?" >> ":"    ")+curr+"| "+line}).join("\n");err.path=filename;err.message=(filename||"ejs")+":"+lineno+"\n"+context+"\n\n"+err.message;throw err}try{var buf=[];with(locals||{}){(function(){buf.push('<!-- TrackListItem View -->\n<div class="track ',escape((__stack.lineno=2,published?"published":"")),'">\n    <div class="display">\n        <input class="track-check check" type="checkbox"',escape((__stack.lineno=4,published?'checked="checked"':"")),'/>\n        <div class="track-content">\n            <a href="/tracks/',escape((__stack.lineno=6,id)),'">',escape((__stack.lineno=6,title)),'</a>\n        </div>\n        <span class="track-destroy destroy"></span>\n    </div>\n    <div class="edit">\n        <input class="track-input" type="text" value="',escape((__stack.lineno=11,title)),'" />\n    </div>\n</div>')})()}return buf.join("")}catch(err){rethrow(err,__stack.input,__stack.filename,__stack.lineno)}}},{}],31:[function(require,module,exports){module.exports=function anonymous(locals,filters,escape){escape=escape||function(html){return String(html).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var __stack={lineno:1,input:'<% if (total) { %>\n    <span class="track-count">\n        <span class="number"><%= remaining %></span>\n        <span class="word"><%= remaining == 1 ? \'item\' : \'items\' %></span> left.\n    </span>\n<% } %>\n<% if (published) { %>\n    <span class="track clear">\n        <a href="#">\n            Clear<span class="number-done"> <%= published %></span>\n            checked <span class="word-done"><%= published == 1 ? \'item\' : \'items\' %></span>\n        </a>\n    </span>\n<% } %>\n',filename:"/Users/MoDrama/Documents/workspace/backbone-revisited/public/js/templates/tracklistStats.ejs"};function rethrow(err,str,filename,lineno){var lines=str.split("\n"),start=Math.max(lineno-3,0),end=Math.min(lines.length,lineno+3);var context=lines.slice(start,end).map(function(line,i){var curr=i+start+1;return(curr==lineno?" >> ":"    ")+curr+"| "+line}).join("\n");err.path=filename;err.message=(filename||"ejs")+":"+lineno+"\n"+context+"\n\n"+err.message;throw err}try{var buf=[];with(locals||{}){(function(){buf.push("");__stack.lineno=1;if(total){buf.push('\n    <span class="track-count">\n        <span class="number">',escape((__stack.lineno=3,remaining)),'</span>\n        <span class="word">',escape((__stack.lineno=4,remaining==1?"item":"items")),"</span> left.\n    </span>\n");
__stack.lineno=6}buf.push("\n");__stack.lineno=7;if(published){buf.push('\n    <span class="track clear">\n        <a href="#">\n            Clear<span class="number-done"> ',escape((__stack.lineno=10,published)),'</span>\n            checked <span class="word-done">',escape((__stack.lineno=11,published==1?"item":"items")),"</span>\n        </a>\n    </span>\n");__stack.lineno=14}buf.push("\n")})()}return buf.join("")}catch(err){rethrow(err,__stack.input,__stack.filename,__stack.lineno)}}},{}],32:[function(require,module,exports){var global=typeof self!=="undefined"?self:typeof window!=="undefined"?window:{};"use strict";var _=require("underscore"),Backbone=require("../backbone/backbone-modified"),template=require("../templates/songlistItem.ejs");module.exports=Backbone.AnywhereView.extend({tagName:"li",template:template,events:{"click .song-check":"toggleActivated","dblclick div.song-content":"edit","click span.song-destroy":"remove","keypress .song-input":"updateOnEnter"},initialize:function(){this.listenTo(this.model,"change",this.render);this.listenTo(this.model,"destroy",this.remove);this._enrich();this.model.view=this},render:function(){this.$el.html(this.template(this.model.toJSON()));this._enrich();return this},_enrich:function(){if(global.ONSERVER){return}this.input=this.$(".song-input").on("blur",_.bind(this.close,this))},toggleActivated:function(){this.model.toggle()},edit:function(){this.$el.addClass("editing");this.input.focus()},close:function(){this.model.save({title:this.input.val()});this.$el.removeClass("editing")},updateOnEnter:function(e){if(e.keyCode===13){this.close()}},remove:function(){if(this.removing){return}this.removing=true;this.model.destroy();Backbone.AnywhereView.prototype.remove.apply(this)},clear:function(){this.model.clear()}})},{"../backbone/backbone-modified":13,"../templates/songlistItem.ejs":26,underscore:10}],33:[function(require,module,exports){"use strict";var _=require("underscore"),Backbone=require("../backbone/backbone-modified"),template=require("../templates/songlist.ejs"),songlistStatsTemplate=require("../templates/songlistStats.ejs");module.exports=Backbone.AnywhereView.extend({el:"#songlist-view",template:template,statsTemplate:songlistStatsTemplate,events:{"keypress .song-new":"createOnEnter","keyup .song-new":"showTooltip","click .song.clear a":"clearCompleted"},initialize:function(){this.input=this.$(".song-new");this.listenTo(this.collection,"add",this.addOne);this.listenTo(this.collection,"reset",this.addAll);this.listenTo(this.collection,"all",this.render)},render:function(){var html=this.statsTemplate({total:this.collection.length,published:this.collection.published().length,remaining:this.collection.remaining().length});this.$(".songlist-stats").html(html)},addOne:function(song,index){if(this.collection.limit&&index===this.collection.limit[1]){return}var SongListItemView=require("../views/index").SongListItem;var $el=new SongListItemView({model:song}).render().$el;this.$(".songlist").append($el)},addAll:function(){this.$(".songlist").html("");this.collection.each(this.addOne.bind(this))},newAttributes:function(){return{title:this.input.val(),order:this.collection.nextOrder(),published:false}},createOnEnter:function(e){if(e.keyCode!==13){return}this.collection.create(this.newAttributes(),{wait:true});this.input.val("")},clearCompleted:function(){_.each(this.collection.published(),function(song){song.destroy()});return false},showTooltip:function(e){var tooltip=this.$(".ui-tooltip-top");var val=this.input.val();tooltip.fadeOut();if(this.tooltipTimeout){clearTimeout(this.tooltipTimeout)}if(val===""||val===this.input.attr("placeholder")){return}var show=function(){tooltip.show().fadeIn()};this.tooltipTimeout=_.delay(show,1e3)}})},{"../backbone/backbone-modified":13,"../templates/songlist.ejs":25,"../templates/songlistStats.ejs":27,"../views/index":38,underscore:10}],34:[function(require,module,exports){"use strict";var _=require("underscore"),Backbone=require("../backbone/backbone-modified"),models=require("../models/index"),TrackListView=require("./TrackListView"),template=require("../templates/song.ejs");module.exports=Backbone.AnywhereView.extend({el:"#song-view",template:template,subViews:{},events:{"dblclick div.content":"edit","click span.destroy":"clear","blur .song-input":"close"},initialize:function(){this.initModel();this.input=this.$(".song-input")},initModel:function(){this.model.view=this;this.collection=new models.TrackCollection(this.model.get("tracks"));this.collection.songId=this.model.id;this.listenTo(this.model,"change",function(){this.render();this.collection.set(this.model.get("tracks"))});this.render();this.initTracksView()},initTracksView:function(){this.subViews.trackList=new TrackListView({el:".tracklist-subview",collection:this.collection})},render:function(){var self=this;_.each(this.model.toJSON(),function(val,prop){var isBool=_.isBoolean(val);if(!isBool&&val&&typeof val==="object"){return}if(isBool){val=val?"yes":"no"}self.$("span."+prop).html(val+"");self.$("input."+prop).val(val+"")});return this},edit:function(){this.$el.addClass("editing");this.input.focus()},close:function(){this.model.save({title:this.input.val()});this.$el.removeClass("editing")},updateOnEnter:function(e){if(e.keyCode===13){this.close()}},clear:function(){this.model.clear()}})},{"../backbone/backbone-modified":13,"../models/index":20,"../templates/song.ejs":24,"./TrackListView":36,underscore:10}],35:[function(require,module,exports){var global=typeof self!=="undefined"?self:typeof window!=="undefined"?window:{};"use strict";var _=require("underscore"),Backbone=require("../backbone/backbone-modified"),template=require("../templates/tracklistItem.ejs");module.exports=Backbone.AnywhereView.extend({tagName:"li",template:template,events:{"click .track-check":"toggleActivated","dblclick div.track-content":"edit","click span.track-destroy":"remove","keypress .track-input":"updateOnEnter"},initialize:function(){this.listenTo(this.model,"change",this.render,this);this.listenTo(this.model,"destroy",this.remove,this);this._enrich();this.model.view=this},render:function(){this.$el.html(this.template(this.model.toJSON()));this._enrich();return this},_enrich:function(){if(global.ONSERVER){return}this.input=this.$(".track-input").on("blur",_.bind(this.close,this))},toggleActivated:function(){this.model.toggle()},edit:function(){this.$el.addClass("editing");this.input.focus()},close:function(){this.model.save({title:this.input.val()});this.$el.removeClass("editing")},updateOnEnter:function(e){if(e.keyCode===13){this.close()}},remove:function(){if(this.removing){return}this.removing=true;this.model.destroy();Backbone.AnywhereView.prototype.remove.apply(this)},clear:function(){this.model.clear()}})},{"../backbone/backbone-modified":13,"../templates/tracklistItem.ejs":30,underscore:10}],36:[function(require,module,exports){"use strict";var _=require("underscore"),Backbone=require("../backbone/backbone-modified"),template=require("../templates/tracklist.ejs"),tracklistStatsTemplate=require("../templates/tracklistStats.ejs");module.exports=Backbone.AnywhereView.extend({el:"#tracklist-view",template:template,statsTemplate:tracklistStatsTemplate,events:{"keypress .track-new":"createOnEnter","keyup .track-new":"showTooltip","click .track.clear a":"clearCompleted"},initialize:function(){this.input=this.$(".track-new");this.listenTo(this.collection,"add",function(){this.collection.trigger("reset")},this);this.listenTo(this.collection,"reset",this.addAll);this.listenTo(this.collection,"all",this.render)},render:function(){var html=this.statsTemplate({total:this.collection.length,published:this.collection.published().length,remaining:this.collection.remaining().length});this.$(".tracklist-stats").html(html)},addOne:function(track,index){if(this.collection.limit&&index===this.collection.limit[1]){return}var TrackListItemView=require("./TrackListItemView");var $el=new TrackListItemView({model:track}).render().$el;this.$(".tracklist").append($el)},addAll:function(){this.$(".tracklist").html("");this.collection.each(this.addOne.bind(this))},newAttributes:function(){return{songId:this.collection.songId,title:this.input.val(),order:this.collection.nextOrder(),published:false}},createOnEnter:function(e){if(e.keyCode!==13){return}this.collection.create(this.newAttributes(),{wait:true});this.input.val("")},clearCompleted:function(){_.each(this.collection.published(),function(track){track.destroy()});return false},showTooltip:function(e){var tooltip=this.$(".ui-tooltip-top");var val=this.input.val();tooltip.fadeOut();if(this.tooltipTimeout){clearTimeout(this.tooltipTimeout)}if(val===""||val===this.input.attr("placeholder")){return}var show=function(){tooltip.show().fadeIn()};this.tooltipTimeout=_.delay(show,1e3)}})},{"../backbone/backbone-modified":13,"../templates/tracklist.ejs":29,"../templates/tracklistStats.ejs":31,"./TrackListItemView":35,underscore:10}],37:[function(require,module,exports){var global=typeof self!=="undefined"?self:typeof window!=="undefined"?window:{};"use strict";var root=typeof window==="undefined"?global:window,_=require("underscore"),Backbone=require("../backbone/backbone-modified"),template=require("../templates/track.ejs");module.exports=Backbone.AnywhereView.extend({el:"#track-view",template:template,events:{"dblclick div.content":"edit","click span.destroy":"clear","blur .track-input":"close"},initialize:function(){this.initModel()},initModel:function(){this.listenTo(this.model,"change",this.render);this.model.view=this;this.render()},render:function(){this.$el.html(this.template(this.model.toJSON()));return this},edit:function(){this.$el.addClass("editing");this.input.focus()},close:function(){this.model.save({title:this.input.val()});this.$el.removeClass("editing")},updateOnEnter:function(e){if(e.keyCode===13){this.close()}},clear:function(){this.model.clear()}})},{"../backbone/backbone-modified":13,"../templates/track.ejs":28,underscore:10}],38:[function(require,module,exports){if(typeof module==="undefined"){module={}}module.exports={SongList:require("./SongListView"),SongListItem:require("./SongListItemView"),Song:require("./SongView"),TrackList:require("./TrackListView"),TrackListItem:require("./TrackListItemView"),Track:require("./TrackView")}},{"./SongListItemView":32,"./SongListView":33,"./SongView":34,"./TrackListItemView":35,"./TrackListView":36,"./TrackView":37}]},{},[15]);